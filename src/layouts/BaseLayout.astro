---
import BaseHead from "../components/BaseHead.astro";

const { title, description, image } = Astro.props;
---

<!doctype html>
<html lang="en" class="h-full antialiased">
  <head>
    <BaseHead title={title} description={description} image={image} />

    <script is:inline>
      let dark = false;
      if (localStorage.getItem("darkMode")) {
        dark = JSON.parse(localStorage.getItem("darkMode") ?? "false");
      } else {
        dark = window.matchMedia("(prefers-color-scheme: dark)").matches;
      }

      var root = document.getElementsByTagName("html")[0];
      if (dark) {
        root.classList.add("dark");
      } else {
        root.classList.remove("dark");
      }
    </script>

    <style is:global>
      html.dark .astro-code,
      html.dark .astro-code span {
        color: var(--shiki-dark);
      }

      html:not(dark) .astro-code,
      html:not(dark) .astro-code span {
        color: var(--shiki-light);
      }

      pre {
        @apply overflow-hidden !important;
        @apply border border-base-300 dark:border-base-700 bg-base-200/50 dark:bg-base-950/30 rounded-xl !important;
      }

      .line.highlighted {
        margin: 0 -24px;
        padding: 0 24px;
        position: relative;

        display: inline-block;
        width: calc(100% + 48px);
      }
      .line.highlighted {
        @apply bg-accent-500/10 dark:bg-accent-700/10;
      }

      ::selection {
        @apply bg-accent-300/50 dark:bg-accent-900/40;
      }

      lite-youtube {
        @apply rounded-xl border border-base-300 dark:border-base-700;
      }

      .prose mark {
        @apply bg-accent-200 dark:bg-accent-900 text-black dark:text-white;
      }
      .MathJax svg {
        display: inline !important;
      }

      /* ---- Code block title bar ---- */
      .has-code-title {
        @apply border border-base-300 dark:border-base-700 rounded-xl overflow-hidden;
        margin-top: 1.7142857em;
        margin-bottom: 1.7142857em;
      }

      .has-code-title pre {
        margin: 0 !important;
        border: none !important;
        border-radius: 0 !important;
      }

      .code-title-bar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 0.5rem;
        padding: 0.4rem 0.75rem;
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
        font-size: 0.8rem;
        line-height: 1.5;
        @apply bg-base-300/40 dark:bg-base-800/60;
        @apply text-base-500 dark:text-base-400;
        @apply border-b border-base-300 dark:border-base-700;
      }

      .code-title-text {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        min-width: 0;
      }

      .code-title-copy {
        flex-shrink: 0;
        font-size: 0.75rem;
        padding: 0.1rem 0.5rem;
        border-radius: 0.375rem;
        cursor: pointer;
        transition: background-color 150ms, color 150ms;
        @apply text-base-500 dark:text-base-400;
        @apply hover:bg-base-300/80 dark:hover:bg-base-700/80;
      }

      .code-title-copy.copied {
        @apply text-green-700 dark:text-green-300;
        @apply bg-green-200/60 dark:bg-green-900/50;
      }

      /* SVG dark mode global override */
      html.dark .svg-wrapper svg * {
        stroke: #fff !important;
        fill: #fff !important;
      }
      html.dark .svg-wrapper svg *[fill="none"] {
        fill: none !important;
      }
    </style>
  </head>

  <body class="dark:bg-base-950 flex mx-1 sm:mx-4 transition-all duration-150">
    <div class="max-w-5xl mx-auto my-1 sm:my-8 w-full">
      <div class="w-full">
        <slot />
      </div>
    </div>

    <script
      is:inline
      src="https://storage.ko-fi.com/cdn/scripts/overlay-widget.js"></script>
    <script is:inline>
      kofiWidgetOverlay.draw("1ilhas", {
        type: "floating-chat",
        "floating-chat.donateButton.text": "Support Me",
        "floating-chat.donateButton.background-color": "#794bc4",
        "floating-chat.donateButton.text-color": "#fff",
      });
    </script>
  </body>
</html>
